---
title: "HW_13"
author: "Cody Grainger"
date: "`r format(Sys.time(), '%d %B %Y')`"
output: html_notebook
editor_options: 
  chunk_output_type: inline
---

### Libraries

Initial libraries
```{r}
library(here)
library(raster)
library(sf)
library(tidyverse)
library(ggthemes)
library(patchwork)
library(maptools)
library(ggmap)
library(marmap)

```

#### Part 1: Outline maps

### Notes

The end product for this section is a U.S. map with missouri filled in black and 3 other states filled in gray.

packages 'map_data' and 'subset' are used to access specific regions (states)

```{r}
# Outline of the 48 contiguous states
usa <- map_data(map="state")

# Outline of just Missouri
us_missouri <- map_data(map="state",
                        region="missouri")

# Outline of Alabama, Florida, Mississippe, and North Carolina
us_other <- subset(x=usa,
                   subset=region %in% c("alabama",
                                        "florida",
                                        "mississippi",
                                        "north carolina"))
```

observing the structure of the usa data frame
```{r}
str(usa)
head(usa)
```

Plotting the 'us_other' states. the fill is set to "gray"
```{r}
ggplot()+
  geom_polygon(data=us_other,
               aes(x=long,y=lat,
                   group=group),
               fill="gray")
```

The code below will add missouri with the fill set to "black" to the original plot.
```{r}
ggplot()+
  geom_polygon(data=us_other,
               aes(x=long,y=lat,
                   group=group),
               fill="gray") +
  geom_polygon(data=us_missouri,
               aes(x=long,y=lat,
                   group=group),
               fill="black")
```

The outline of the US mainland is added
```{r}
ggplot()+
  geom_polygon(data=us_other,
               aes(x=long,y=lat,
                   group=group),
               fill="gray") +
  geom_polygon(data=us_missouri,
               aes(x=long,y=lat,
                   group=group),
               fill="black") +
  geom_polygon(data=usa,
               aes(x=long,y=lat,
                   group=group),
               fill=NA,
               color="black")
```

# US map
 
Now adding the map theme from 'ggthemes' and a coord_fixed layer set to 1.3
```{r}
us_map <- ggplot()+
  geom_polygon(data=us_other,
               aes(x=long,y=lat,
                   group=group),
               fill="gray") +
  geom_polygon(data=us_missouri,
               aes(x=long,y=lat,
                   group=group),
               fill="black") +
  geom_polygon(data=usa,
               aes(x=long,y=lat,
                   group=group),
               fill=NA,
               color="black") +
  theme_map() +
  coord_fixed(1.3)

us_map
```

# Missouri map

A map of missouri divided by counties with scott county filled in black
```{r}
missouri <- map_data("county","missouri")
mo_scott <- subset(missouri, subregion %in% c("scott"))

mo_map <- ggplot() +
  geom_polygon(data=missouri,aes(x=long,y=lat,group=group),fill=NA,color="black") +
  geom_polygon(data=mo_scott,aes(x=long,y=lat,group=group),fill="black") +
  theme_map() +
  coord_fixed(1.3)

mo_map
```

using the patchwork package to set the us map and missouri map side by side. width of the us map is set to 1.5 times wider
```{r}
us_map + mo_map + plot_layout(ncol=2,widths=c(1.5,1))
```

